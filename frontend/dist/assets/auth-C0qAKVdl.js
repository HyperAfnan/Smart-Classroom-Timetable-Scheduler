import{j as e,r as x,c as A,b as B,s as p,e as P,f as H,L as O}from"./index-DMwWV6LZ.js";import{B as w}from"./button-DdLPv1v6.js";import{m as r}from"./proxy-BVDPlYaL.js";import{B as L}from"./building-2-BtY7HNjz.js";import{c as I}from"./createLucideIcon-De5o52GV.js";import{I as y}from"./input-D6FpiF2T.js";import{L as v,a as R}from"./label-w-tQkdvG.js";import{M as T}from"./map-pin-ZKOn9kME.js";import{A as _}from"./arrow-right-DCXva8BU.js";import{M as q}from"./mail-Ct3AERel.js";import{A as U}from"./index-Bs2UPQaf.js";import"./index-B5rXH1kc.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],J=I("arrow-left",z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],W=I("log-in",M);function $({activeMode:t,setActiveMode:l}){return e.jsxs("div",{className:"relative bg-slate-100 rounded-2xl p-2 mb-8",children:[e.jsx(r.div,{className:"absolute top-2 bottom-2 bg-white rounded-xl shadow-lg border border-slate-200/50",animate:{left:t==="register"?"0.5rem":"50%",right:t==="register"?"50%":"0.5rem"},transition:{type:"spring",stiffness:300,damping:30}}),e.jsxs("div",{className:"relative grid grid-cols-2 gap-2",children:[e.jsxs(r.button,{onClick:()=>l("register"),className:`relative z-10 flex items-center justify-center gap-3 py-4 px-6 rounded-xl font-semibold transition-colors duration-300 ${t==="register"?"text-purple-700":"text-slate-600 hover:text-slate-800"}`,whileHover:{scale:t!=="register"?1.02:1},whileTap:{scale:.98},children:[e.jsx(L,{className:"w-5 h-5"}),"Register as University"]}),e.jsxs(r.button,{onClick:()=>l("login"),className:`relative z-10 flex items-center justify-center gap-3 py-4 px-6 rounded-xl font-semibold transition-colors duration-300 ${t==="login"?"text-purple-700":"text-slate-600 hover:text-slate-800"}`,whileHover:{scale:t!=="login"?1.02:1},whileTap:{scale:.98},children:[e.jsx(W,{className:"w-5 h-5"}),"Login"]})]})]})}function V(){const[t,l]=x.useState({universityName:"",universityLocation:""}),[i,g]=x.useState(!1),h=(a,u)=>{l(j=>({...j,[a]:u}))},f=async a=>{a.preventDefault(),!(!t.universityName||!t.universityLocation)&&(g(!0),await new Promise(u=>setTimeout(u,1e3)),localStorage.setItem("universityData",JSON.stringify(t)),g(!1))},m=t.universityName.trim()&&t.universityLocation.trim();return e.jsxs(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.4,ease:"easeOut"},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Register Your University"}),e.jsx("p",{className:"text-slate-600",children:"Let's start by collecting some basic information about your institution"})]}),e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"universityName",className:"text-sm font-medium text-slate-700",children:"University Name *"}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),e.jsx(y,{id:"universityName",type:"text",placeholder:"Enter your university name",value:t.universityName,onChange:a=>h("universityName",a.target.value),className:"pl-12 py-3 text-lg border-slate-300 focus:border-purple-500 focus:ring-purple-500/20"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"universityLocation",className:"text-sm font-medium text-slate-700",children:"University Location *"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),e.jsx(y,{id:"universityLocation",type:"text",placeholder:"City, State/Province, Country",value:t.universityLocation,onChange:a=>h("universityLocation",a.target.value),className:"pl-12 py-3 text-lg border-slate-300 focus:border-purple-500 focus:ring-purple-500/20"})]})]}),e.jsx(r.div,{whileHover:{scale:m?1.02:1},whileTap:{scale:m?.98:1},className:"pt-4",children:e.jsx(w,{type:"submit",disabled:!m||i,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed group",children:i?e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full"}):e.jsxs(e.Fragment,{children:["Continue Setup",e.jsx(_,{className:"ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})}),e.jsx("p",{className:"text-sm text-slate-500 text-center",children:"By registering, you agree to our Terms of Service and Privacy Policy"})]})]})}function G(){const t=A(),l=B(),[i,g]=x.useState({email:"",password:""}),[h,f]=x.useState(!1),[m,a]=x.useState(null),u=(c,s)=>{g(b=>({...b,[c]:s}))},j=async c=>{if(c.preventDefault(),a(null),!i.email||!i.password)return;f(!0);const{data:s,error:b}=await p.auth.signInWithPassword({email:String(i.email),password:String(i.password)});if(b){a(b.message),f(!1);return}let d=[];const{data:D,error:S}=await p.from("user_roles").select("roles(role_name)").eq("user_id",s.user.id);S?a(S.message):d=D?.map(o=>o.roles?.role_name).filter(Boolean);let C={};try{C=P(s.session.access_token)}catch{}if(d.includes("admin")||d.includes("teacher")){const{data:o,error:n}=await p.from("teacher_profile").select("*").eq("email",s.user.email).single();n?a(n.message):s.user={...s.user,...o};const{data:F,error:k}=await p.from("teacher_subjects").select("subject").eq("teacher",o.name);k?a(k.message):s.user={...s.user,subjects:F.map(E=>E.subject)}}if(d.includes("hod")){const{data:o,error:n}=await p.from("hod_profile").select("*").eq("userId",s.user.id).single();n?a(n.message):s.user={...s.user,...o}}if(d.includes("student")){const{data:o,error:n}=await p.from("student_profile").select("*").eq("userId",s.user.id).single();n?a(n.message):s.user={...s.user,...o}}t(H({user:s.user,token:s.session.access_token,roles:d})),localStorage.setItem("user",JSON.stringify(s.user)),localStorage.setItem("token",s.session.access_token),localStorage.setItem("roles",JSON.stringify(d)),f(!1),l("/dashboard")},N=i.email.trim()&&i.password.trim();return m&&console.log(m),e.jsxs(r.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.4,ease:"easeOut"},children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Welcome Back"}),e.jsx("p",{className:"text-slate-600",children:"Sign in to your university account to continue"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email Address *"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),e.jsx(y,{id:"email",type:"email",placeholder:"Enter your email address",value:i.email,onChange:c=>u("email",c.target.value),className:"pl-12 py-3 text-lg border-slate-300 focus:border-purple-500 focus:ring-purple-500/20"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"password",className:"text-sm font-medium text-slate-700",children:"Password *"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),e.jsx(y,{id:"password",type:"password",placeholder:"Enter your password",value:i.password,onChange:c=>u("password",c.target.value),className:"pl-12 py-3 text-lg border-slate-300 focus:border-purple-500 focus:ring-purple-500/20"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"flex items-center gap-2 text-slate-600",children:[e.jsx("input",{type:"checkbox",className:"rounded border-slate-300"}),"Remember me"]}),e.jsx("a",{href:"#",className:"text-purple-600 hover:text-purple-700 font-medium",children:"Forgot password?"})]}),e.jsx(r.div,{whileHover:{scale:N?1.02:1},whileTap:{scale:N?.98:1},className:"pt-4",children:e.jsx(w,{type:"submit",disabled:!N||h,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white py-3 text-lg font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed group",children:h?e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full"}):e.jsxs(e.Fragment,{children:["Sign In",e.jsx(_,{className:"ml-2 w-5 h-5 group-hover:translate-x-1 transition-transform"})]})})})]})]})}function oe(){const[t,l]=x.useState("register");return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-purple-50/30 flex items-center justify-center p-6",children:e.jsxs("div",{className:"w-full max-w-2xl",children:[e.jsx(r.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6},className:"mb-8",children:e.jsx(O,{to:"/",children:e.jsxs(w,{variant:"ghost",className:"text-slate-600 hover:text-slate-900 p-2",children:[e.jsx(J,{className:"w-5 h-5 mr-2"}),"Back to Home"]})})}),e.jsxs(r.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{duration:.8,ease:"easeOut"},className:"bg-white/80 backdrop-blur-sm rounded-3xl border border-slate-200/50 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-slate-100 to-slate-50 px-8 py-6 border-b border-slate-200/50",children:e.jsxs(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-slate-900 to-slate-700 bg-clip-text text-transparent mb-2",children:"Welcome to Calvio"}),e.jsx("p",{className:"text-slate-600",children:"Get started with intelligent university scheduling"})]})}),e.jsx("div",{className:"p-8 pb-4",children:e.jsx($,{activeMode:t,setActiveMode:l})}),e.jsx("div",{className:"px-8 pb-8",children:e.jsx(U,{mode:"wait",children:t==="register"?e.jsx(V,{},"register"):e.jsx(G,{},"login")})})]})]})})}export{oe as default};
