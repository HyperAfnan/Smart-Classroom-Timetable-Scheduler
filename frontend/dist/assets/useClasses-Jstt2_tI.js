import{u as F,q as h}from"./queryKeys-B8YbpHg6.js";import{g as K,s as f}from"./index-DMwWV6LZ.js";import{u as S}from"./useMutation-rOajDVhN.js";const l=h.classes,B=Object.freeze([]);async function D(){const{data:n,error:s}=await f.from("classes").select("*").order("created_at",{ascending:!1});if(s)throw new Error(s.message||"Failed to load classes");return n??[]}async function P(n){const{data:s,error:t}=await f.from("classes").insert([n]).select("*").single();if(t)throw new Error(t.message||"Failed to create class");return s}async function I({id:n,updates:s}){const{data:t,error:c}=await f.from("classes").update(s).eq("id",n).select("*").single();if(c)throw new Error(c.message||"Failed to update class");return t}async function L(n){const{error:s}=await f.from("classes").delete().eq("id",n);if(s)throw new Error(s.message||"Failed to delete class");return{id:n}}function T({classesQueryOptions:n={},createOptions:s,updateOptions:t,deleteOptions:c}={}){const u=K(),y=F({queryKey:l.all,queryFn:D,staleTime:6e4,...n}),d=S({mutationFn:P,onSuccess:async(r,e,a)=>{u.setQueryData(l.all,i=>{const o=Array.isArray(i)?i:[];return[r,...o]}),await u.invalidateQueries({queryKey:l.all}),s?.onSuccess&&s.onSuccess(r,e,a)},onError:(r,e,a)=>{s?.onError&&s.onError(r,e,a)},...s}),m=S({mutationFn:I,onSuccess:async(r,e,a)=>{u.setQueryData(l.all,i=>Array.isArray(i)?i.map(o=>o?.id===r?.id?{...o,...r}:o):i),await u.invalidateQueries({queryKey:l.all}),t?.onSuccess&&t.onSuccess(r,e,a)},onError:(r,e,a)=>{t?.onError&&t.onError(r,e,a)},...t}),E=S({mutationFn:L,onSuccess:async(r,e,a)=>{const i=r?.id??e;u.setQueryData(l.all,o=>Array.isArray(o)?o.filter(Q=>Q?.id!==i):o),await u.invalidateQueries({queryKey:l.all}),c?.onSuccess&&c.onSuccess(r,e,a)},onError:(r,e,a)=>{c?.onError&&c.onError(r,e,a)},...c}),g=!!(d.isPending||m.isPending),w=!!E.isPending,A=d.mutateAsync,C=m.mutateAsync,q=E.mutateAsync;return{classes:y.data??B,isLoading:y.isLoading,isError:y.isError,error:y.error??null,refetch:y.refetch,classesQuery:y,createClassAsync:A,updateClassAsync:C,deleteClassAsync:q,createStatus:d,updateStatus:m,deleteStatus:E,isSubmitting:g,isDeleting:w}}export{T as u};
