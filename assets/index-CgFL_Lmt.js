import{r as t,j as v}from"./index-DgwETXXl.js";import{a as S}from"./utils-CHUdG8Hq.js";import{M as T,i as W,u as I,P as A,a as D,b as H,L as K}from"./proxy-BwaxQ4ZJ.js";function _({className:r,type:s,...e}){return t.createElement("input",{type:s,"data-slot":"input",className:S("file:text-card-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...e})}class U extends t.Component{getSnapshotBeforeUpdate(s){const e=this.props.childRef.current;if(e&&s.isPresent&&!this.props.isPresent){const f=e.offsetParent,m=W(f)&&f.offsetWidth||0,n=this.props.sizeRef.current;n.height=e.offsetHeight||0,n.width=e.offsetWidth||0,n.top=e.offsetTop,n.left=e.offsetLeft,n.right=m-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function B({children:r,isPresent:s,anchorX:e,root:f}){const m=t.useId(),n=t.useRef(null),h=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:g}=t.useContext(T);return t.useInsertionEffect(()=>{const{width:C,height:i,top:y,left:o,right:d}=h.current;if(s||!n.current||!C||!i)return;const c=e==="left"?`left: ${o}`:`right: ${d}`;n.current.dataset.motionPopId=m;const a=document.createElement("style");g&&(a.nonce=g);const u=f??document.head;return u.appendChild(a),a.sheet&&a.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${C}px !important;
            height: ${i}px !important;
            ${c}px !important;
            top: ${y}px !important;
          }
        `),()=>{u.contains(a)&&u.removeChild(a)}},[s]),v.jsx(U,{isPresent:s,childRef:n,sizeRef:h,children:t.cloneElement(r,{ref:n})})}const F=({children:r,initial:s,isPresent:e,onExitComplete:f,custom:m,presenceAffectsLayout:n,mode:h,anchorX:g,root:C})=>{const i=I(G),y=t.useId();let o=!0,d=t.useMemo(()=>(o=!1,{id:y,initial:s,isPresent:e,custom:m,onExitComplete:c=>{i.set(c,!0);for(const a of i.values())if(!a)return;f&&f()},register:c=>(i.set(c,!1),()=>i.delete(c))}),[e,i,f]);return n&&o&&(d={...d}),t.useMemo(()=>{i.forEach((c,a)=>i.set(a,!1))},[e]),t.useEffect(()=>{!e&&!i.size&&f&&f()},[e]),h==="popLayout"&&(r=v.jsx(B,{isPresent:e,anchorX:g,root:C,children:r})),v.jsx(A.Provider,{value:d,children:r})};function G(){return new Map}const R=r=>r.key||"";function j(r){const s=[];return t.Children.forEach(r,e=>{t.isValidElement(e)&&s.push(e)}),s}const q=({children:r,custom:s,initial:e=!0,onExitComplete:f,presenceAffectsLayout:m=!0,mode:n="sync",propagate:h=!1,anchorX:g="left",root:C})=>{const[i,y]=D(h),o=t.useMemo(()=>j(r),[r]),d=h&&!i?[]:o.map(R),c=t.useRef(!0),a=t.useRef(o),u=I(()=>new Map),[$,k]=t.useState(o),[x,P]=t.useState(o);H(()=>{c.current=!1,a.current=o;for(let p=0;p<x.length;p++){const l=R(x[p]);d.includes(l)?u.delete(l):u.get(l)!==!0&&u.set(l,!1)}},[x,d.length,d.join("-")]);const w=[];if(o!==$){let p=[...o];for(let l=0;l<x.length;l++){const b=x[l],E=R(b);d.includes(E)||(p.splice(l,0,b),w.push(b))}return n==="wait"&&w.length&&(p=w),P(j(p)),k(o),null}const{forceRender:L}=t.useContext(K);return v.jsx(v.Fragment,{children:x.map(p=>{const l=R(p),b=h&&!i?!1:o===x||d.includes(l),E=()=>{if(u.has(l))u.set(l,!0);else return;let M=!0;u.forEach(z=>{z||(M=!1)}),M&&(L?.(),P(a.current),h&&y?.(),f&&f())};return v.jsx(F,{isPresent:b,initial:!c.current||e?void 0:!1,custom:s,presenceAffectsLayout:m,mode:n,root:C,onExitComplete:b?void 0:E,anchorX:g,children:p},l)})})};export{q as A,_ as I};
