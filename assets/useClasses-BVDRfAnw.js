import{u as h,q as l}from"./queryKeys-DEtgRCDz.js";import{h as F,s as f}from"./index-DtPpba_i.js";import{u as S}from"./useMutation-BejmEQSl.js";const K=Object.freeze([]);async function B(){const{data:n,error:s}=await f.from("classes").select("*").order("created_at",{ascending:!1});if(s)throw new Error(s.message||"Failed to load classes");return n??[]}async function D(n){const{data:s,error:t}=await f.from("classes").insert([n]).select("*").single();if(t)throw new Error(t.message||"Failed to create class");return s}async function P({id:n,updates:s}){const{data:t,error:c}=await f.from("classes").update(s).eq("id",n).select("*").single();if(c)throw new Error(c.message||"Failed to update class");return t}async function I(n){const{error:s}=await f.from("classes").delete().eq("id",n);if(s)throw new Error(s.message||"Failed to delete class");return{id:n}}function M({classesQueryOptions:n={},createOptions:s,updateOptions:t,deleteOptions:c}={}){const u=F(),y=h({queryKey:l.classes.all,queryFn:B,staleTime:6e4,...n}),d=S({mutationFn:D,onSuccess:async(e,r,a)=>{u.setQueryData(l.classes.all,i=>{const o=Array.isArray(i)?i:[];return[e,...o]}),await u.invalidateQueries({queryKey:l.classes.all}),s?.onSuccess&&s.onSuccess(e,r,a)},onError:(e,r,a)=>{s?.onError&&s.onError(e,r,a)},...s}),m=S({mutationFn:P,onSuccess:async(e,r,a)=>{u.setQueryData(l.classes.all,i=>Array.isArray(i)?i.map(o=>o?.id===e?.id?{...o,...e}:o):i),await u.invalidateQueries({queryKey:l.classes.all}),t?.onSuccess&&t.onSuccess(e,r,a)},onError:(e,r,a)=>{t?.onError&&t.onError(e,r,a)},...t}),E=S({mutationFn:I,onSuccess:async(e,r,a)=>{const i=e?.id??r;u.setQueryData(l.classes.all,o=>Array.isArray(o)?o.filter(Q=>Q?.id!==i):o),await u.invalidateQueries({queryKey:l.classes.all}),c?.onSuccess&&c.onSuccess(e,r,a)},onError:(e,r,a)=>{c?.onError&&c.onError(e,r,a)},...c}),w=!!(d.isPending||m.isPending),g=!!E.isPending,A=d.mutateAsync,C=m.mutateAsync,q=E.mutateAsync;return{classes:y.data??K,isLoading:y.isLoading,isError:y.isError,error:y.error??null,refetch:y.refetch,classesQuery:y,createClassAsync:A,updateClassAsync:C,deleteClassAsync:q,createStatus:d,updateStatus:m,deleteStatus:E,isSubmitting:w,isDeleting:g}}export{M as u};
